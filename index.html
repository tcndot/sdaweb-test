<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SDA Infra & Promoters</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:0;color:#111}
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    /* placeholder so header injection area doesn't jump */
    #headerdiv { width:100%; }
  </style>
</head>
<body>
  <!-- keep your existing layout: header will be injected here -->
  <div id="headerdiv" aria-hidden="true"></div>

  <main class="wrap">
    <h1>Welcome</h1>
    <p>Replace this content with your existing index content. This file is intentionally minimal so we don't redesign anything.</p>
  </main>

  <div id="footerdiv" aria-hidden="true"></div>

  <script>
    // loadHTML: fetch partial, insert, and execute any <script> tags inside it.
    async function loadHTML(targetId, relPath) {
      const target = document.getElementById(targetId);
      if (!target) return;
      try {
        const url = new URL(relPath, location.href).href;
        const res = await fetch(url, {cache:'no-store'});
        if (!res.ok) throw new Error(`${res.status} ${res.statusText} for ${url}`);
        const text = await res.text();
        const tmp = document.createElement('div');
        tmp.innerHTML = text;

        // append non-script nodes
        Array.from(tmp.childNodes).forEach(node => {
          if (node.tagName && node.tagName.toLowerCase() === 'script') return;
          target.appendChild(node.cloneNode(true));
        });

        // run scripts
        const scripts = tmp.querySelectorAll('script');
        for (const s of scripts) {
          const newScript = document.createElement('script');
          for (const attr of s.attributes) newScript.setAttribute(attr.name, attr.value);
          if (s.src) {
            // external -> append & wait
            await new Promise((resLoad) => {
              newScript.onload = resLoad;
              newScript.onerror = resLoad; // don't block on failure
              document.body.appendChild(newScript);
              newScript.src = s.src;
            });
          } else {
            newScript.textContent = s.textContent;
            document.body.appendChild(newScript);
          }
        }

        target.setAttribute('aria-hidden','false');
      } catch (err) {
        console.error('loadHTML error', err);
        target.innerHTML = '<div style="padding:12px;background:#fee;color:#600">Failed to load header/footer</div>';
        target.setAttribute('aria-hidden','true');
      }
    }

    (async function init() {
      await loadHTML('headerdiv','header.html'); // loads header and runs its script
      await loadHTML('footerdiv','footer.html'); // footer optional; safe if exists
    })();
  </script>
</body>
</html>
