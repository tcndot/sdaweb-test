<!-- HEADER START -->
<style>
  :root { --topbar-height: 52px; --topbar-bg: linear-gradient(135deg,#1a3a1a,#2e7d32); }

  /* ---------- Top bar (fixed, always visible) ---------- */
  .top-bar {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: var(--topbar-height);
    background: var(--topbar-bg);
    color: #e8f5e8;
    padding: 8px 4vw;
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 3000;               /* high so dropdown sits above content */
    box-sizing: border-box;
    font-weight: 700;
  }
  .top-left {
    display:flex;
    align-items:center;
    gap:10px;
    min-width: 0;
  }
  .phone-link {
    display:flex;
    align-items:center;
    gap:8px;
    color: #e8f5e8;
    text-decoration: none;
  }
  .phone-link svg { width:18px; height:18px; fill: #e8f5e8; display:block; }

  /* ---------- Menu button (in top bar, right) ---------- */
  .top-menu-wrap {
    margin-left: auto;
    position: relative;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .menu-btn {
    background: rgba(255,255,255,0.95);
    color: #1a3a1a;
    border: 1px solid rgba(26,58,26,0.12);
    padding: 8px 12px;
    border-radius: 10px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-weight: 800;
    font-size: 0.95rem;
    box-shadow: 0 4px 14px rgba(26,58,26,0.06);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .menu-btn:hover { transform: translateY(-2px); }
  .menu-btn:focus { outline: none; box-shadow: 0 0 0 4px rgba(46,125,50,0.12); }

  .menu-btn .arrow {
    display:inline-block;
    width: 12px; height: 12px;
    transform-origin: center;
    transition: transform .18s ease;
    font-size: 12px;
    line-height: 1;
  }
  .menu-btn[aria-expanded="true"] .arrow { transform: rotate(180deg); }

  /* ---------- Dropdown panel anchored under top-bar ---------- */
  .menu-dropdown {
    position: fixed;
    right: 4vw; /* aligned to menu button visually */
    top: calc(var(--topbar-height) + 10px);
    width: min(92vw, 360px);
    max-height: 60vh;
    overflow: auto;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 14px 40px rgba(10,20,10,0.15);
    border: 1px solid rgba(0,0,0,0.06);
    padding: 12px;
    z-index: 2999;
    transform-origin: top right;
    transform: scale(.98);
    opacity: 0;
    pointer-events: none;
    transition: transform .14s ease, opacity .14s ease;
  }
  .menu-dropdown.open {
    transform: scale(1);
    opacity: 1;
    pointer-events: auto;
  }
  .menu-dropdown ul { list-style: none; padding: 6px 4px; margin: 0; }
  .menu-dropdown li { margin: 6px 0; }
  .menu-dropdown a {
    color: #12321a;
    text-decoration: none;
    font-weight: 700;
    display: inline-block;
    padding: 8px 10px;
    border-radius: 8px;
  }
  .menu-dropdown a:hover, .menu-dropdown a:focus {
    background: #f1f7f1;
    color: #0b3a13;
    outline: none;
  }
  .menu-dropdown .menu-note { color: #666; font-size: 0.9rem; padding: 4px 8px; }

  /* small screens: dropdown full width under top-bar */
  @media (max-width: 420px) {
    .menu-dropdown { right: 6px; left: 6px; width: auto; max-width: none; }
    .menu-btn { padding: 8px 10px; }
  }

  /* ---------- Header / Branding area (below top-bar) ---------- */
  .header-bar {
    margin-top: calc(var(--topbar-height) + 10px);
    display: flex;
    align-items: center;
    padding: 12px 4vw;
    background: linear-gradient(135deg,#fff,#f0f7f0);
    box-sizing: border-box;
    z-index: 1060;
  }
  .branding {
    display:flex;
    align-items:center;
    gap:14px;
    min-width: 0;
  }
  .branding-link { display:flex; align-items:center; gap:12px; text-decoration:none; color:inherit; }
  .logo-img { width: 64px; height: 64px; object-fit: contain; border-radius: 12px; background: #fff; border: 3px solid #1a3a1a; }
  .companyNameTop {
    font-size: 1.6rem;
    font-weight: 900;
    letter-spacing: 1.4px;
    color: #1a3a1a;
    white-space: nowrap;
  }

  /* ensure dropdown doesn't hide behind header on z-index collisions */
  .menu-dropdown { z-index: 2999; }

  /* small screens: slightly smaller branding */
  @media (max-width: 540px) {
    .logo-img { width: 48px; height: 48px; }
    .companyNameTop { font-size: 1.15rem; }
    .top-bar { padding: 8px 3vw; height: calc(var(--topbar-height) - 2px); }
  }
</style>

<!-- Topbar (fixed) -->
<div class="top-bar" role="banner">
  <div class="top-left">
    <a class="phone-link" href="tel:9999944622" aria-label="Call SDA Infra and Promoters">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24 11.36 11.36 0 003.55.57 1 1 0 011 1V21a1 1 0 01-1 1A17 17 0 013 5a1 1 0 011-1h3.5a1 1 0 011 1c0 1.21.2 2.41.57 3.55a1 1 0 01-.25 1.01l-2.2 2.23z"/></svg>
      <span>Call: 9999944622</span>
    </a>
  </div>

  <!-- menu button sits in top bar, right aligned -->
  <div class="top-menu-wrap">
    <button id="topMenuBtn" class="menu-btn" aria-haspopup="true" aria-expanded="false" aria-controls="topMenuDropdown">
      <span>Menu</span>
      <span class="arrow" aria-hidden="true">▾</span>
    </button>
  </div>
</div>

<!-- Dropdown panel (lazy-populated) -->
<div id="topMenuDropdown" class="menu-dropdown" role="menu" aria-labelledby="topMenuBtn" tabindex="-1">
  <div class="menu-note">Loading navigation…</div>
</div>

<!-- Branding area below top-bar -->
<header class="header-bar" role="navigation" aria-label="Main header">
  <div class="branding">
    <a href="https://sdapromoters.com" class="branding-link" target="_blank" rel="noopener">
      <img class="logo-img" src="images/logo.png" alt="SDA Infra & Promoters logo">
      <div class="companyNameTop">SDA Infra & Promoters</div>
    </a>
  </div>
</header>

<script>
(function(){
  const btn = document.getElementById('topMenuBtn');
  const dropdown = document.getElementById('topMenuDropdown');

  let menuLoaded = false;

  async function loadMenuHtml() {
    // fetch menu.html and insert into the dropdown
    try {
      const url = new URL('menu.html', location.href).href;
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
      const html = await res.text();

      // sanitize minimal: place inside wrapper (we don't parse scripts)
      dropdown.innerHTML = html.trim();

      // if the loaded html contains a <ul> or links, ensure they have role/menuitem-like focus styles
      dropdown.querySelectorAll('a').forEach(a => {
        a.setAttribute('role','menuitem');
        a.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') closeMenu();
        });
      });

      // if no list present, fallback to simple list from anchors in html
      if (!dropdown.querySelector('ul') && dropdown.querySelectorAll('a').length === 0) {
        dropdown.innerHTML = '<div class="menu-note">No navigation found.</div>';
      }

      menuLoaded = true;
    } catch (err) {
      console.error('Menu load failed:', err);
      dropdown.innerHTML = '<div class="menu-note" style="color:#b33;">Failed to load menu</div>';
      menuLoaded = true;
    }
  }

  function openMenu() {
    btn.setAttribute('aria-expanded','true');
    dropdown.classList.add('open');
    // focus first focusable item in dropdown or the dropdown itself
    const firstLink = dropdown.querySelector('a');
    if (firstLink) firstLink.focus();
    else dropdown.focus();
    document.addEventListener('click', outsideClickHandler);
    document.addEventListener('keydown', keyHandler);
  }

  function closeMenu() {
    btn.setAttribute('aria-expanded','false');
    dropdown.classList.remove('open');
    btn.focus();
    document.removeEventListener('click', outsideClickHandler);
    document.removeEventListener('keydown', keyHandler);
  }

  function outsideClickHandler(e) {
    if (!dropdown.contains(e.target) && !btn.contains(e.target)) closeMenu();
  }

  function keyHandler(e) {
    if (e.key === 'Escape') closeMenu();
    // Arrow keys navigation within dropdown
    if (['ArrowDown','ArrowUp'].includes(e.key) && dropdown.classList.contains('open')) {
      const items = Array.from(dropdown.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])')).filter(Boolean);
      if (items.length === 0) return;
      e.preventDefault();
      const idx = items.indexOf(document.activeElement);
      if (e.key === 'ArrowDown') {
        const next = items[(idx + 1) % items.length];
        next.focus();
      } else {
        const prev = items[(idx - 1 + items.length) % items.length];
        prev.focus();
      }
    }
  }

  btn.addEventListener('click', async (e) => {
    const open = btn.getAttribute('aria-expanded') === 'true';
    if (open) { closeMenu(); return; }

    // load menu if not loaded
    if (!menuLoaded) {
      dropdown.innerHTML = '<div class="menu-note">Loading navigation…</div>';
      await loadMenuHtml();
    }
    openMenu();
  });

  // allow toggle via Enter/Space when focused
  btn.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      if (!dropdown.classList.contains('open')) btn.click();
      const first = dropdown.querySelector('a, button, [tabindex]:not([tabindex="-1"])');
      if (first) first.focus();
    }
  });

  // Close dropdown when any internal link is clicked (so navigation can proceed)
  dropdown.addEventListener('click', (e) => {
    const a = e.target.closest('a');
    if (a) closeMenu();
  });

  // If user resizes and dropdown would go off-screen, adjust position (keep right aligned)
  window.addEventListener('resize', () => {
    // nothing complex required; CSS handles full width small screens
  });
})();
</script>
<!-- HEADER END -->
